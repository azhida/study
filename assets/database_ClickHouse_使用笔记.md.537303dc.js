import{_ as s,o as a,c as e,Q as l}from"./chunks/framework.aaef0e9b.js";const g=JSON.parse('{"title":"ClickHouse 使用笔记","description":"","frontmatter":{},"headers":[],"relativePath":"database/ClickHouse/使用笔记.md","lastUpdated":1680584985000}'),n={name:"database/ClickHouse/使用笔记.md"},t=l(`<h1 id="clickhouse-使用笔记" tabindex="-1">ClickHouse 使用笔记 <a class="header-anchor" href="#clickhouse-使用笔记" aria-label="Permalink to &quot;ClickHouse 使用笔记&quot;">​</a></h1><p><a href="https://clickhouse.com" target="_blank" rel="noreferrer">ClickHouse官网</a></p><h2 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h2><p><a href="https://clickhouse.com/docs/zh/getting-started/install/" target="_blank" rel="noreferrer">官网安装部署教程</a></p><p>参考：<a href="https://blog.csdn.net/daerzei/article/details/113818931" target="_blank" rel="noreferrer">Ubuntu20安装clickhouse最新版本详细教程</a></p><p>参考：<a href="https://www.136.la/nginx/show-27924.html" target="_blank" rel="noreferrer">Ubuntu下ClickHouse安装(示例代码)</a></p><h2 id="注意" tabindex="-1">注意 <a class="header-anchor" href="#注意" aria-label="Permalink to &quot;注意&quot;">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;"># 启动 clickhouse-server</span></span>
<span class="line"><span style="color:#babed8;">service clickhouse-server start</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>此时如果clickhouse-server启动不了，排查</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;"># 查看错误日志是什么回事，发现9000端口已被占用</span></span>
<span class="line"><span style="color:#babed8;">tail -10 /var/log/clickhouse-server/clickhouse-server.log</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;"># 如果提示权限相关，则 将相关文件和文件夹 所属用户和所属组 改为 clickhouse:clickhouse</span></span>
<span class="line"><span style="color:#babed8;">sudo chown -R clickhouse:clickhouse /var/lib/clickhouse/*</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>解决：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">vi /etc/clickhouse-server/config.xml</span></span>
<span class="line"><span style="color:#babed8;"></span></span>
<span class="line"><span style="color:#babed8;"># 找到&lt;tcp_port&gt;9000&lt;/tcp_port&gt;  把9000改为其他端口如:9001</span></span>
<span class="line"><span style="color:#babed8;"># 还有一个问题就是ipv4和ipv6的问题，如果服务器不支持ipv6，那么把listen_host冒号去掉改为自己的IP地址，或0.0.0.0表示所有ip都能接入 </span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><h3 id="浏览器访问-http-ip-8123-失败的排查解决" tabindex="-1">浏览器访问 <code>http://ip:8123</code> 失败的排查解决 <a class="header-anchor" href="#浏览器访问-http-ip-8123-失败的排查解决" aria-label="Permalink to &quot;浏览器访问 \`http://ip:8123\` 失败的排查解决&quot;">​</a></h3><ul><li>确认 8123 端口已开放</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;"># 开放 8123端口</span></span>
<span class="line"><span style="color:#babed8;">ufw allow 8123</span></span>
<span class="line"><span style="color:#babed8;"># 重启防火墙</span></span>
<span class="line"><span style="color:#babed8;">ufw reload</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><ul><li>确认 配置文件 <code>listen_host</code> 已启用</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">vim /etc/clickhouse-server/config.xml</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>找到 <code>listen_host</code> ，大概在 line:178<br> 支持 IP6 则 开启 <code>&lt;listen_host&gt;::&lt;/listen_host&gt;</code> ， 不支持 IP6 则 开启 <code>&lt;listen_host&gt;0.0.0.0&lt;/listen_host&gt;</code></p><p>保存后重启 clickhouse-server</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">clickhouse restart</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><p>再次访问 <code>http://ip:8123</code> 就看到 输出 <code>ok.</code> 了</p>`,22),o=[t];function c(p,i,r,d,h,b){return a(),e("div",null,o)}const k=s(n,[["render",c]]);export{g as __pageData,k as default};
