import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.aaef0e9b.js";const B=JSON.parse('{"title":"抖音自动刷视频","description":"","frontmatter":{},"headers":[],"relativePath":"other/自动化测试/抖音自动刷视频.md","lastUpdated":1693558184000}'),p={name:"other/自动化测试/抖音自动刷视频.md"},o=l(`<h1 id="抖音自动刷视频" tabindex="-1">抖音自动刷视频 <a class="header-anchor" href="#抖音自动刷视频" aria-label="Permalink to &quot;抖音自动刷视频&quot;">​</a></h1><h2 id="环境搭建" tabindex="-1">环境搭建 <a class="header-anchor" href="#环境搭建" aria-label="Permalink to &quot;环境搭建&quot;">​</a></h2><h3 id="python" tabindex="-1">python <a class="header-anchor" href="#python" aria-label="Permalink to &quot;python&quot;">​</a></h3><h3 id="appium" tabindex="-1">appium <a class="header-anchor" href="#appium" aria-label="Permalink to &quot;appium&quot;">​</a></h3><h3 id="木木模拟器" tabindex="-1">木木模拟器 <a class="header-anchor" href="#木木模拟器" aria-label="Permalink to &quot;木木模拟器&quot;">​</a></h3><h3 id="下载-抖音-apk-包并安装到模拟器中" tabindex="-1">下载 抖音 apk 包并安装到模拟器中 <a class="header-anchor" href="#下载-抖音-apk-包并安装到模拟器中" aria-label="Permalink to &quot;下载 抖音 apk 包并安装到模拟器中&quot;">​</a></h3><h2 id="相关命令" tabindex="-1">相关命令 <a class="header-anchor" href="#相关命令" aria-label="Permalink to &quot;相关命令&quot;">​</a></h2><ul><li>python 安装 Appium-Python-Client</li></ul><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pip</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">install</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Appium-Python-Client</span><span style="color:#BABED8;"> </span></span>
<span class="line"></span></code></pre></div><ul><li>启动 appium 服务</li><li>连接模拟器</li></ul><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 木木模拟器</span></span>
<span class="line"><span style="color:#FFCB6B;">adb</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">connect</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">127.0</span><span style="color:#C3E88D;">.0.1:7555</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 夜神模拟器</span></span>
<span class="line"><span style="color:#FFCB6B;">adb</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">connect</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">127.0</span><span style="color:#C3E88D;">.0.1:62001</span></span>
<span class="line"></span></code></pre></div><ul><li>查看设备</li></ul><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">adb</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">devices</span></span>
<span class="line"></span></code></pre></div><ul><li><p>查看当前运行的 APP 包名 <code>appPackage</code> 和活动页 <code>appActivity</code></p><p>注意要先在模拟器打开 抖音极速版APP，否则看不到相关信息</p></li></ul><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">adb</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">shell</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">dumpsys</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">window</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">|</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">findstr</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">mCurrentFocus</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># mCurrentFocus=Window{a179906 u0 com.ss.android.ugc.aweme/com.ss.android.ugc.aweme.splash.SplashActivity}</span></span>
<span class="line"></span></code></pre></div><p>包名： <code>com.ss.android.ugc.aweme</code> 活动页： <code>com.ss.android.ugc.aweme.splash.SplashActivity</code></p><h2 id="python-脚本" tabindex="-1">python 脚本 <a class="header-anchor" href="#python-脚本" aria-label="Permalink to &quot;python 脚本&quot;">​</a></h2><div class="language-py"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> appium </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> webdriver</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> appium</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">webdriver</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">common</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">touch_action </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> TouchAction</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> selenium</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">webdriver</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">common</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">by </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> By</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> selenium</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">webdriver</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">support</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">wait </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> WebDriverWait</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> selenium</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">webdriver</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">support </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> expected_conditions </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#BABED8;"> ec</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">desired_caps </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">platformName</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Android</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">deviceName</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">127.0.0.1:7555</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;"># 通过 adb devices命令获取</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">appPackage</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.ss.android.ugc.aweme</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">appActivity</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.ss.android.ugc.aweme.splash.SplashActivity</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">appWaitDuration</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">200000</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">driver </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> webdriver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Remote</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://127.0.0.1:4723/wd/hub</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">desired_capabilities</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">desired_caps</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">implicitly_wait</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;"># 等待弹框元素</span></span>
<span class="line"><span style="color:#BABED8;">driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">find_element</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">By</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">XPATH</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">//*[@text=&#39;同意&#39;]</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">click</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">implicitly_wait</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;"># 等待弹框元素</span></span>
<span class="line"><span style="color:#BABED8;">driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">find_element</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">By</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">XPATH</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">//*[@text=&#39;允许&#39;]</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">click</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">time</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sleep</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1.5</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">size </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get_window_size</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">width</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> height </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> size</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">width</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">],</span><span style="color:#BABED8;"> size</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">height</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;"># 获取屏幕宽高</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">action </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">TouchAction</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">driver</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#BABED8;"> i </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">range</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;"># 实现滑动</span></span>
<span class="line"><span style="color:#BABED8;">    action</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">press</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">x</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">width </span><span style="color:#89DDFF;">/</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">y</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">height </span><span style="color:#89DDFF;">/</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">*</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">wait</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">500</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">move_to</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">x</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">width </span><span style="color:#89DDFF;">/</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">y</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">height </span><span style="color:#89DDFF;">/</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">release</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">    action</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">perform</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#676E95;font-style:italic;"># 3s后 弹框元素不出现，直接跳过继续执行</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#82AAFF;">WebDriverWait</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">driver</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">until</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ec</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">presence_of_element_located</span><span style="color:#89DDFF;">((</span><span style="color:#82AAFF;">By</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">XPATH</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">//*[@text=&#39;允许&#39;]</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)))</span></span>
<span class="line"><span style="color:#BABED8;">        driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">find_element</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">By</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">XPATH</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">//*[@text=&#39;允许&#39;]</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">click</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;font-style:italic;">except</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;font-style:italic;">pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">time</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sleep</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close_app</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">quit</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span></code></pre></div><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><p><a href="https://it.cha138.com/nginx/show-3111002.html" target="_blank" rel="noreferrer">Python自动化抖音自动刷视频</a></p>`,20),e=[o];function t(c,r,F,D,y,i){return a(),n("div",null,e)}const d=s(p,[["render",t]]);export{B as __pageData,d as default};
