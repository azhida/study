import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.aaef0e9b.js";const A=JSON.parse('{"title":"Laravel 集成 DynamoDB 替换 MySQL","description":"","frontmatter":{},"headers":[],"relativePath":"server/php/laravel/laravel集成DynamoDB替换MySQL.md","lastUpdated":1715420968000}'),p={name:"server/php/laravel/laravel集成DynamoDB替换MySQL.md"},o=l(`<h1 id="laravel-集成-dynamodb-替换-mysql" tabindex="-1">Laravel 集成 DynamoDB 替换 MySQL <a class="header-anchor" href="#laravel-集成-dynamodb-替换-mysql" aria-label="Permalink to &quot;Laravel 集成 DynamoDB 替换 MySQL&quot;">​</a></h1><p>要在 Laravel 项目中集成 DynamoDB 以替换 MySQL，你需要使用 Laravel 的数据库抽象层，并配置 DynamoDB 作为你的数据库连接。以下是步骤和示例代码：</p><h2 id="安装-aws-sdk-for-php-包" tabindex="-1">安装 AWS SDK for PHP 包： <a class="header-anchor" href="#安装-aws-sdk-for-php-包" aria-label="Permalink to &quot;安装 AWS SDK for PHP 包：&quot;">​</a></h2><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">composer</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">require</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">aws/aws-sdk-php</span></span>
<span class="line"></span></code></pre></div><h2 id="修改-env-文件-设置-dynamodb-的配置信息" tabindex="-1">修改 <code>.env</code> 文件，设置 DynamoDB 的配置信息： <a class="header-anchor" href="#修改-env-文件-设置-dynamodb-的配置信息" aria-label="Permalink to &quot;修改 \`.env\` 文件，设置 DynamoDB 的配置信息：&quot;">​</a></h2><ul><li><code>.env</code></li></ul><div class="language-env"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">AWS_ACCESS_KEY_ID=your_access_key</span></span>
<span class="line"><span style="color:#babed8;">AWS_SECRET_ACCESS_KEY=your_secret_key</span></span>
<span class="line"><span style="color:#babed8;">AWS_DEFAULT_REGION=us-east-1</span></span>
<span class="line"><span style="color:#babed8;">AWS_DB_TABLE=your_dynamodb_table</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre></div><h2 id="创建一个新的-dynamodbserviceprovider-来扩展-laravel-的服务提供者功能" tabindex="-1">创建一个新的 DynamoDbServiceProvider 来扩展 Laravel 的服务提供者功能 <a class="header-anchor" href="#创建一个新的-dynamodbserviceprovider-来扩展-laravel-的服务提供者功能" aria-label="Permalink to &quot;创建一个新的 DynamoDbServiceProvider 来扩展 Laravel 的服务提供者功能&quot;">​</a></h2><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">php</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">.</span><span style="color:#BABED8;">\\a</span><span style="color:#C3E88D;">rtisan</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">make:provider</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">DynamoDbServiceProvider</span></span>
<span class="line"></span></code></pre></div><ul><li><code>app/Providers/DynamoDbServiceProvider.php</code></li></ul><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#BABED8;">php</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#F78C6C;">namespace</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">App</span><span style="color:#89DDFF;">\\</span><span style="color:#FFCB6B;">Providers</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#BABED8;">Illuminate</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Support</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">ServiceProvider</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#BABED8;">Aws</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">DynamoDb</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">DynamoDbClient</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#BABED8;">Illuminate</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Support</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Facades</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Schema</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#BABED8;">Illuminate</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Database</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Capsule</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Manager</span><span style="color:#FFCB6B;"> </span><span style="color:#F78C6C;">as</span><span style="color:#FFCB6B;"> Capsule</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">DynamoDbServiceProvider</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">extends</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">ServiceProvider</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">public</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">boot</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">$this-&gt;</span><span style="color:#82AAFF;">setupDynamoDb</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">public</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">setupDynamoDb</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">dynamoDb </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">new</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">DynamoDbClient</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">version</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">latest</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">region</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">env</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">AWS_DEFAULT_REGION</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">us-east-1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">db </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">env</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">AWS_DB_TABLE</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">capsule </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">new</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Capsule</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">capsule</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">addConnection</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">driver</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dynamodb</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">key</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">       </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">dynamoDb</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">table</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">     </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">db</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">region</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">env</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">AWS_DEFAULT_REGION</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">us-east-1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">capsule</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">setAsGlobal</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">capsule</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">bootEloquent</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="在-config-app-php-的-providers-数组中添加新的服务提供者" tabindex="-1">在 <code>config/app.php</code> 的 providers 数组中添加新的服务提供者： <a class="header-anchor" href="#在-config-app-php-的-providers-数组中添加新的服务提供者" aria-label="Permalink to &quot;在 \`config/app.php\` 的 providers 数组中添加新的服务提供者：&quot;">​</a></h2><ul><li><code>config/app.php</code></li></ul><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">providers</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">ServiceProvider</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">defaultProviders</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">merge</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#BABED8;">    App</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Providers</span><span style="color:#89DDFF;">\\</span><span style="color:#FFCB6B;">DynamoDbServiceProvider</span><span style="color:#89DDFF;">::</span><span style="color:#F78C6C;">class</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">])-&gt;</span><span style="color:#82AAFF;">toArray</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><h2 id="使用-eloquent-模型与-dynamodb-表交互-例如创建一个新的-user-模型" tabindex="-1">使用 Eloquent 模型与 DynamoDB 表交互，例如创建一个新的 User 模型： <a class="header-anchor" href="#使用-eloquent-模型与-dynamodb-表交互-例如创建一个新的-user-模型" aria-label="Permalink to &quot;使用 Eloquent 模型与 DynamoDB 表交互，例如创建一个新的 User 模型：&quot;">​</a></h2><ul><li><code>app/Models/User.php</code></li></ul><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#BABED8;">php</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#BABED8;">Illuminate</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Database</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Eloquent</span><span style="color:#89DDFF;">\\</span><span style="color:#BABED8;">Model</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">User</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">extends</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Model</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">protected</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">table </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">users</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;">// DynamoDB 表名</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">protected</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">primaryKey </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 其他 Eloquent 方法</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="使用新的模型进行数据库操作" tabindex="-1">使用新的模型进行数据库操作： <a class="header-anchor" href="#使用新的模型进行数据库操作" aria-label="Permalink to &quot;使用新的模型进行数据库操作：&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">user </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">User</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">where</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">email</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">example@example.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)-&gt;</span><span style="color:#82AAFF;">first</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">user</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#BABED8;">name </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">New Name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#BABED8;">user</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">save</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span></code></pre></div>`,19),e=[o];function c(t,r,D,y,F,B){return a(),n("div",null,e)}const E=s(p,[["render",c]]);export{A as __pageData,E as default};
