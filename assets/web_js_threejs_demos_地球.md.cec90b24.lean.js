var at=Object.defineProperty;var ct=(e,t,r)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var x=(e,t,r)=>(ct(e,typeof t!="symbol"?t+"":t,r),r);import{R as it,V as Fe,C as Be,a as lt,s as ut,A as dt,T as we}from"./chunks/three.module.410ec4f2.js";import{d as I,C as A,D as _,h as w,a5 as Ie,w as X,a6 as Me,j as Oe,f as q,F as De,B as Y,a7 as Ke,a8 as Z,S as E,v as pt,a9 as ft,i as mt,o as re,y as $e,z as ht,x as z,b as ee,c as yt,a as Ue,Q as bt}from"./chunks/framework.aaef0e9b.js";const J=(e,t,r)=>{if(!t)return;const n=Array.isArray(t)?t:t.match(/([^[.\]])+/g),o=n==null?void 0:n.reduce((c,i)=>c&&c[i],e);return o===void 0?r:o},gt=()=>{const e="[object Number]",r=Object.prototype.toString;function n(c){return!!c&&typeof c=="object"}return function(i){return typeof i=="number"||n(i)&&r.call(i)==e}},xt=gt(),vt=(e,t,r)=>{const n=Array.isArray(t)?t:t.match(/([^[.\]])+/g);n==null||n.reduce((o,c,i)=>(o[c]===void 0&&(o[c]={}),i===n.length-1&&(o[c]=r),o[c]),e)},At=e=>["onClick","onContextMenu","onDoubleClick","onPointerUp","onPointerDown","onPointerOver","onPointerOut","onPointerEnter","onPointerLeave","onPointerMove","onWheel"].includes(e),V=e=>{var t;return(e==null?void 0:e.metaType)==="domMeta"?!0:(t=e==null?void 0:e.props)==null?void 0:t["data-lunchbox"]},j=e=>(e==null?void 0:e.metaType)==="standardMeta",oe=e=>e.isLunchboxRootNode;function Rt(e={}){const t={text:e.text??""};return new G.RendererCommentNode({...t,...e,metaType:"commentMeta"})}function Ct(e={}){const r={domElement:document.createElement(e.type??"")};return new G.RendererDomNode({...r,...e,metaType:"domMeta"})}function Et(e={}){const t={text:e.text??""};return new G.RendererTextNode({...e,...t,metaType:"textMeta"})}function Pt(e={},t={}){const r={attached:e.attached??[],attachedArray:e.attachedArray??{},instance:e.instance??null},n=new G.RendererStandardNode({...e,...r,metaType:"standardMeta"});return n.type&&!oe(n)&&!n.instance&&(n.instance=Kt({...n,props:{...n.props,...t}})),n}function Ft({node:e,key:t,interactables:r,value:n}){return e.eventListeners[t]||(e.eventListeners[t]=[]),e.eventListenerRemoveFunctions[t]||(e.eventListenerRemoveFunctions[t]=[]),e.eventListeners[t].push(n),Bt.includes(t)&&e.instance&&!r.value.includes(e)&&(r.value.push(e),e.eventListenerRemoveFunctions[t].push(()=>{const o=r.value.indexOf(e);o!==-1&&r.value.splice(o,1)})),e}const Bt=["onClick","onPointerUp","onPointerDown","onPointerOver","onPointerOut","onPointerEnter","onPointerLeave","onPointerMove"],Le=(e,t,r,n,o)=>{var i,d;if(!(t!=null&&t.domElement)||!r||!e)return;n=n??window.innerWidth,o=o??window.innerHeight;const c=n/o;if(((i=e.type)==null?void 0:i.toLowerCase())==="perspectivecamera"){const p=e;p.aspect=c,p.updateProjectionMatrix()}else if(((d=e.type)==null?void 0:d.toLowerCase())==="orthographiccamera"){const p=e,s=o/n;p.top=s*10,p.bottom=-s*10,p.right=10,p.left=-10,p.updateProjectionMatrix()}t.setSize(n,o),r&&e&&t.render(Z(r),Z(e))},wt=e=>{const t=getComputedStyle(e),r=e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight),n=e.clientHeight-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom);return{width:r,height:n}},Dt=(e,t,r,n,o)=>{var p;const c=(p=e.value)==null?void 0:p.domElement;if(!c)throw new Error("missing container");const i=()=>{if(o==="container"){const s=wt(c);Le(t,r,n,s.width,s.height)}else Le(t,r,n)};i();let d=new ResizeObserver(()=>{i()});return c&&d.observe(c),{dispose(){c&&d.unobserve(c)}}},Lt=I({name:"LunchboxScene",setup(e,{slots:t}){return()=>A(_("scene"),null,{default:()=>{var r;return[(r=t.default)==null?void 0:r.call(t)]}})}}),Nt=I({name:"LunchboxEventHandlers",setup(){const e=ot(),t=rt(),r=w({x:1/0,y:1/0}),n=w(!1);let o=[];const c=new it(new Fe,new Fe(0,0,-1)),i=({element:l,eventKeys:f,intersection:h})=>{l&&f.forEach(g=>{l.eventListeners[g]&&l.eventListeners[g].forEach(R=>{R({intersection:h})})})};gn(l=>{if(!(l!=null&&l.domElement))return;const{domElement:f}=l,h=B=>{const u=(f.width??1)/t.dpr,m=(f.height??1)/t.dpr;r.value.x=B.offsetX/u*2-1,r.value.y=-(B.offsetY/m)*2+1},g=()=>n.value=!0,R=()=>n.value=!1;f.addEventListener("pointermove",h),f.addEventListener("pointerdown",g),f.addEventListener("pointerup",R)});const d=bn(),p=()=>{const l=d.value;if(!l)return;c.setFromCamera(r.value,l);const f=c.intersectObjects((e==null?void 0:e.value.map(u=>u.instance))??[]);let h=[],g=[],R=[];h=o.map(u=>u.intersection),f==null||f.forEach(u=>{if(o.findIndex(y=>y.intersection.object===u.object)===-1){const y=e==null?void 0:e.value.find(C=>{var P;return((P=C.instance)==null?void 0:P.uuid)===u.object.uuid});y&&g.push({element:y,intersection:u})}else{const y=e==null?void 0:e.value.find(C=>{var P;return((P=C.instance)==null?void 0:P.uuid)===u.object.uuid});y&&R.push({element:y,intersection:u})}const b=h.findIndex(y=>y.object.uuid===u.object.uuid);b!==-1&&h.splice(b,1)});const B=h.map(u=>({element:e==null?void 0:e.value.find(m=>{var b;return((b=m.instance)==null?void 0:b.uuid)===u.object.uuid}),intersection:u}));g.forEach(({element:u,intersection:m})=>{i({element:u,eventKeys:["onPointerEnter"],intersection:m})}),R.forEach(({element:u,intersection:m})=>{i({element:u,eventKeys:["onPointerOver","onPointerMove"],intersection:m})}),B.forEach(({element:u,intersection:m})=>{i({element:u,eventKeys:["onPointerLeave","onPointerOut"],intersection:m})}),o=[].concat(g,R)};tn(p),Ie(()=>nn(p));const a=["onClick","onPointerDown","onPointerUp"];return X(n,l=>{p();const f=[];o.forEach(h=>{a.forEach(g=>{var B,u;const R=h.element.uuid+g;l&&(g==="onClick"||g==="onPointerDown")?f.includes(R)||((B=h.element.eventListeners[g])==null||B.forEach(m=>m({intersection:h.intersection})),f.push(R)):!l&&g==="onPointerUp"&&(f.includes(R)||((u=h.element.eventListeners[g])==null||u.forEach(m=>m({intersection:h.intersection})),f.push(R)))})})}),()=>A(_("object3D"),null,null)}}),Ne=e=>({position:e,top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",display:"block"}),Tt=I({name:"Lunchbox",props:{background:String,cameraArgs:Array,cameraLook:Array,cameraLookAt:Array,cameraPosition:Array,dpr:Number,ortho:Boolean,orthographic:Boolean,r3f:Boolean,rendererArguments:Object,rendererProperties:Object,sizePolicy:String,shadow:[Boolean,Object],transparent:Boolean,zoom:Number,updateSource:Object},setup(e,t){const r=w();let n=e.dpr??-1;const o=w(),c=w(),i=w(),d=w(),p=rt(),s=xn(),a=vn(),l=Me({}),f=An();e.r3f&&Be&&(Be.legacyMode=!1);const h=ot();Oe(async()=>{var y,C,P,D,L,M,O,N,K,T,$,U,S,k,se,ae,ce,ie,le,ue,de,pe,fe,me,he,ye,be,ge,xe,ve,Ae,Re,Ce,H,Ee,Pe;if(!r.value&&!((P=(C=(y=t.slots)==null?void 0:y.renderer)==null?void 0:C.call(y))!=null&&P.length))throw new Error("missing canvas");for((M=(L=(D=t.slots)==null?void 0:D.camera)==null?void 0:L.call(D))!=null&&M.length||(e.cameraPosition&&(l.position=e.cameraPosition),(e.cameraLook||e.cameraLookAt)&&(l.lookAt=e.cameraLook||e.cameraLookAt),e.zoom!==void 0&&(l.zoom=e.zoom)),(N=(O=d.value)==null?void 0:O.$el)!=null&&N.instance&&e.background&&(d.value.$el.instance.background=new lt(e.background)),n===-1&&(n=window.devicePixelRatio),s==null||s({dpr:n});!((T=(K=c.value)==null?void 0:K.$el)!=null&&T.instance)&&!((S=(U=($=c.value)==null?void 0:$.component)==null?void 0:U.ctx.$el)!=null&&S.instance);)await new Promise(F=>requestAnimationFrame(F));for(;!((se=(k=d.value)==null?void 0:k.$el)!=null&&se.instance)&&!((ie=(ce=(ae=d.value)==null?void 0:ae.component)==null?void 0:ce.ctx.$el)!=null&&ie.instance);)await new Promise(F=>requestAnimationFrame(F));const u=((ue=(le=c.value)==null?void 0:le.$el)==null?void 0:ue.instance)??((fe=(pe=(de=c.value)==null?void 0:de.component)==null?void 0:pe.ctx.$el)==null?void 0:fe.instance);u.setPixelRatio(p.dpr);const m=((he=(me=d.value)==null?void 0:me.$el)==null?void 0:he.instance)??((ge=(be=(ye=d.value)==null?void 0:ye.component)==null?void 0:be.ctx.$el)==null?void 0:ge.instance),b=((ve=(xe=i.value)==null?void 0:xe.$el)==null?void 0:ve.instance)??((Ce=(Re=(Ae=i.value)==null?void 0:Ae.component)==null?void 0:Re.ctx.$el)==null?void 0:Ce.instance);if(!((Pe=(Ee=(H=t.slots)==null?void 0:H.renderer)==null?void 0:Ee.call(H))!=null&&Pe.length)){Dt(o,b,u,m,e.sizePolicy),e.r3f&&(u.outputEncoding=ut,u.toneMapping=dt);const F={shadow:e.shadow};F!=null&&F.shadow&&(u.shadowMap.enabled=!0,typeof F.shadow=="object"&&(u.shadowMap.type=F.shadow.type))}if(!a)throw new Error("error creating app");a.config.globalProperties.lunchbox.camera=b,a.config.globalProperties.lunchbox.renderer=u,a.config.globalProperties.lunchbox.scene=m;for(let F of f??[])F({app:a,camera:b,renderer:u,scene:m});et({app:a,camera:b,renderer:u,scene:m,updateSource:e.updateSource})}),Ie(()=>{on(),an()});const g=e.sizePolicy==="container"?"static":"absolute",R=e.sizePolicy==="container"?"static":"fixed",B=q(()=>{var m,b;const u=(b=(m=t.slots)==null?void 0:m.camera)==null?void 0:b.call(m).find(y=>{var C;return(C=y.type)==null?void 0:C.name});return u});return X(B,async(u,m)=>{var b,y;u&&((b=u==null?void 0:u.props)==null?void 0:b.key)!==((y=m==null?void 0:m.props)==null?void 0:y.key)&&(i.value=u)},{immediate:!0}),()=>{var u,m,b,y,C,P,D,L,M,O,N,K,T,$,U;return A(De,null,[(b=(m=(u=t.slots)==null?void 0:u.renderer)==null?void 0:m.call(u))!=null&&b.length?c.value=(C=(y=t.slots)==null?void 0:y.renderer)==null?void 0:C.call(y)[0]:A(De,null,[A("div",{class:"lunchbox-container",style:Ne(g),ref:o,"data-lunchbox":"true"},[A("canvas",{ref:r,class:"lunchbox-canvas",style:Ne(R),"data-lunchbox":"true"},null)]),((P=r.value)==null?void 0:P.domElement)&&A(_("webGLRenderer"),Y(e.rendererProperties??{},{ref:c,args:[{alpha:e.transparent,antialias:!0,canvas:(D=r.value)==null?void 0:D.domElement,powerPreference:e.r3f?"high-performance":"default",...e.rendererArguments??{}}]}),null)]),(O=(M=(L=t.slots)==null?void 0:L.scene)==null?void 0:M.call(L))!=null&&O.length?d.value=(K=(N=t.slots)==null?void 0:N.scene)==null?void 0:K.call(N)[0]:A(Lt,{ref:d},{default:()=>{var S,k;return[(k=(S=t.slots)==null?void 0:S.default)==null?void 0:k.call(S)]}}),(U=($=(T=t.slots)==null?void 0:T.camera)==null?void 0:$.call(T))!=null&&U.length?i.value:e.ortho||e.orthographic?A(_("orthographicCamera"),Y({ref:i,args:e.cameraArgs??[]},l),null):A(_("perspectiveCamera"),Y({ref:i,args:e.cameraArgs??[e.r3f?75:45,.5625,1,1e3]},l),null),(h==null?void 0:h.value.length)&&A(Nt,null,null)])}}}),St=["mesh","instancedMesh","scene","sprite","object3D","instancedBufferGeometry","bufferGeometry","boxBufferGeometry","circleBufferGeometry","coneBufferGeometry","cylinderBufferGeometry","dodecahedronBufferGeometry","extrudeBufferGeometry","icosahedronBufferGeometry","latheBufferGeometry","octahedronBufferGeometry","parametricBufferGeometry","planeBufferGeometry","polyhedronBufferGeometry","ringBufferGeometry","shapeBufferGeometry","sphereBufferGeometry","tetrahedronBufferGeometry","textBufferGeometry","torusBufferGeometry","torusKnotBufferGeometry","tubeBufferGeometry","wireframeGeometry","parametricGeometry","tetrahedronGeometry","octahedronGeometry","icosahedronGeometry","dodecahedronGeometry","polyhedronGeometry","tubeGeometry","torusKnotGeometry","torusGeometry","sphereGeometry","ringGeometry","planeGeometry","latheGeometry","shapeGeometry","extrudeGeometry","edgesGeometry","coneGeometry","cylinderGeometry","circleGeometry","boxGeometry","material","shadowMaterial","spriteMaterial","rawShaderMaterial","shaderMaterial","pointsMaterial","meshPhysicalMaterial","meshStandardMaterial","meshPhongMaterial","meshToonMaterial","meshNormalMaterial","meshLambertMaterial","meshDepthMaterial","meshDistanceMaterial","meshBasicMaterial","meshMatcapMaterial","lineDashedMaterial","lineBasicMaterial","light","spotLightShadow","spotLight","pointLight","rectAreaLight","hemisphereLight","directionalLightShadow","directionalLight","ambientLight","lightShadow","ambientLightProbe","hemisphereLightProbe","lightProbe","texture","videoTexture","dataTexture","dataTexture3D","compressedTexture","cubeTexture","canvasTexture","depthTexture","textureLoader","group","catmullRomCurve3","points","raycaster","cameraHelper","camera","perspectiveCamera","orthographicCamera","cubeCamera","arrayCamera","webGLRenderer"],te={},_t=e=>I({inheritAttrs:!1,name:e,setup(t,r){return()=>{var n,o;return Ke(e,r.attrs,((o=(n=r.slots)==null?void 0:n.default)==null?void 0:o.call(n))||[])}}}),Gt=St.map(_t).reduce((e,t)=>(e[t.name]=t,e),{}),Te={...Gt,Lunchbox:Tt},jt=e=>I({inheritAttrs:!1,name:e,render(){var t,r;return Ke(e,this.$attrs,((r=(t=this.$slots)==null?void 0:t.default)==null?void 0:r.call(t))||[])}}),It=({app:e,...t})=>{Object.keys(t).forEach(r=>{e.component(r,jt(r)),te[r]=t[r]})};function Mt({node:e,prop:t}){return typeof t=="string"&&t.startsWith("$attachedArray")?e.attachedArray[t.replace("$attachedArray.","")]:typeof t=="string"&&t.startsWith("$attached")?e.attached[t.replace("$attached.","")]:t}function Ot({node:e,prop:t}){const r=typeof t=="string"&&t.startsWith("$attachedArray"),n=Mt({node:e,prop:t});return Array.isArray(n)&&r?n:[n]}function Kt(e){if(!e.type)return null;const t=e.type[0].toUpperCase()+e.type.slice(1),r=t.replace(/Lunchbox$/,""),n=te[e.type]||we[t]||te[r]||we[r];if(!n)throw`${t} is not part of the THREE namespace! Did you forget to extend? import {extend} from 'lunchbox'; extend({app, YourComponent, ...})`;const c=(e.props.args??[]).map(p=>Ot({node:e,prop:p}));let i=[];return c.forEach(p=>{i=i.concat(p)}),new n(...i)}var W,$t=new Uint8Array(16);function Ut(){if(!W&&(W=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!W))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return W($t)}var kt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function zt(e){return typeof e=="string"&&kt.test(e)}var v=[];for(var Q=0;Q<256;++Q)v.push((Q+256).toString(16).substr(1));function Ht(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase();if(!zt(r))throw TypeError("Stringified UUID is invalid");return r}function Wt(e,t,r){e=e||{};var n=e.random||(e.rng||Ut)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return Ht(n)}var G;(function(e){class t{constructor(s={},a){x(this,"uuid");x(this,"parentNode");x(this,"children",[]);x(this,"minidomType");this.parentNode=(s==null?void 0:s.parentNode)??a??null,this.minidomType="MinidomBaseNode",this.uuid=(s==null?void 0:s.uuid)??Wt()}get nextSibling(){if(!this.parentNode)return null;const s=this.parentNode.children.findIndex(a=>a.uuid===this.uuid);return s!==-1&&s<this.parentNode.children.length-1?this.parentNode.children[s+1]:null}insertBefore(s,a){s.removeAsChildFromAnyParents(),s.parentNode=this;const l=this.children.findIndex(f=>f.uuid===(a==null?void 0:a.uuid));l!==-1?this.children.splice(l,0,s):this.children.push(s)}removeChild(s){const a=this.children.findIndex(l=>(l==null?void 0:l.uuid)===(s==null?void 0:s.uuid));a!==-1&&this.children.splice(a,1)}addChild(s){return s&&(s.removeAsChildFromAnyParents(),s.parentNode=this,this.insertBefore(s,null)),this}getPath(){const s=[];let a=this;for(;a;)s.unshift(a),a=a.parentNode;return s}drop(){this.removeAsChildFromAnyParents(),this.parentNode=null}walk(s){const a=[this,...this.children],l=[];let f=!0;for(;a.length&&f;){const h=a.shift();if(h){if(l.includes(h))continue;l.push(h),a.push(...h.children.filter(g=>!l.includes(g))),f=s(h)}else f=!1}}removeAsChildFromAnyParents(){var s;(s=this.parentNode)==null||s.removeChild(this)}}e.BaseNode=t;class r extends e.BaseNode{constructor(a={},l){super(a,l);x(this,"eventListeners");x(this,"eventListenerRemoveFunctions");x(this,"name");x(this,"metaType");x(this,"props");x(this,"type");this.minidomType="RendererNode",this.eventListeners={},this.eventListenerRemoveFunctions={},this.name=a.name??"",this.metaType=a.metaType??"standardMeta",this.props=a.props??[],this.type=a.type??""}drop(){super.drop(),Object.keys(this.eventListenerRemoveFunctions).forEach(a=>{this.eventListenerRemoveFunctions[a].forEach(l=>l())})}}e.RendererBaseNode=r;class n extends e.RendererBaseNode{constructor(a={},l){super(a,l);x(this,"domElement");x(this,"isLunchboxRootNode",!0);this.domElement=a.domElement??document.createElement("div")}}e.RendererRootNode=n;class o extends e.RendererBaseNode{constructor(a={},l){super(a,l);x(this,"text");this.text=a.text??""}}e.RendererCommentNode=o;class c extends e.RendererBaseNode{constructor(a={},l){super(a,l);x(this,"domElement");this.domElement=a.domElement??document.createElement("div")}}e.RendererDomNode=c;class i extends e.RendererBaseNode{constructor(a={},l){super(a,l);x(this,"text");this.text=a.text??""}}e.RendererTextNode=i;class d extends e.RendererBaseNode{constructor(a={},l){super(a,l);x(this,"attached");x(this,"attachedArray");x(this,"instance");this.attached=a.attached??[],this.attachedArray=a.attachedArray??{},this.instance=a.instance??null}}e.RendererStandardNode=d})(G||(G={}));const ke="lunchbox-globals",ze="lunchbox-updateGlobals",qt="lunchbox-setCustomRender",Vt="lunchbox-clearCustomRender",Xt="lunchbox-beforeRender",He="lunchbox-onBeforeRender",We="lunchbox-offBeforeRender",Yt="lunchbox-afterRender",Jt="lunchbox-onAfterRender",Qt="lunchbox-offAfterRender",qe="lunchbox-frameId",Ve="lunchbox-watchStopHandle",Zt="lunchbox-appRootNode",Xe="lunchbox-appKey",Ye="lunchbox-renderer",en="lunchbox-scene",Je="lunchbox-camera",Qe="lunchbox-interactables",Ze="lunchbox-startCallback",Se=e=>{typeof e.app.config.globalProperties.lunchbox.frameId=="number"&&cancelAnimationFrame(e.app.config.globalProperties.lunchbox.frameId),e.app.config.globalProperties.lunchbox.frameId=requestAnimationFrame(()=>et({app:e.app,renderer:e.renderer,scene:e.scene,camera:e.camera,updateSource:e.updateSource}))},et=e=>{e.updateSource?e.app.config.globalProperties.lunchbox.watchStopHandle||(e.app.config.globalProperties.lunchbox.watchStopHandle=X(e.updateSource,()=>{Se(e)},{deep:!0})):Se(e);const{app:t,renderer:r,scene:n}=e;t.config.globalProperties.lunchbox.beforeRender.forEach(o=>{o==null||o(e)}),r&&n&&e.app.config.globalProperties.lunchbox.camera&&(t.customRender?t.customRender(e):r.render(Z(n),e.app.config.globalProperties.lunchbox.camera)),t.config.globalProperties.lunchbox.afterRender.forEach(o=>{o==null||o(e)})},tt=()=>({onBeforeRender:E(He),offBeforeRender:E(We)}),tn=(e,t=1/0)=>{var r,n;(n=(r=tt()).onBeforeRender)==null||n.call(r,e,t)},nn=e=>{var t,r;(r=(t=tt()).offBeforeRender)==null||r.call(t,e)},rn=()=>{const e=E(qe);return()=>{e!==void 0&&cancelAnimationFrame(e)}},on=()=>{var e;(e=rn())==null||e()},sn=()=>{const e=E(Ve);return()=>e==null?void 0:e()},an=()=>{var e;(e=sn())==null||e()};function cn({node:e,key:t,interactables:r,value:n}){var s;if(At(t))return Ft({node:e,key:t,interactables:r,value:n});const o=t.replace(/-/g,"."),c=ln[o]||o;if(Ge.includes(t)||Ge.includes(c)||!j(e))return e;if(typeof n=="string"&&n.startsWith("$attached")){const a=n.replace("$attached.","");n=J(e.attached,a,null)}const i=e.instance;if(!i)return e;let d;for(let a=0;a<_e.length&&!d;a++){const f=[_e[a],c].filter(Boolean).join(".");d=d=J(i,f)}if(d&&xt(n)&&(d!=null&&d.setScalar))d.setScalar(n);else if(d&&d.set){const a=Array.isArray(n)?n:[n];i[c].set(...a)}else if(typeof d=="function")if(c.toLowerCase()==="onbeforerender"||c.toLowerCase()==="onafterrender")i[c]=n;else{if(!Array.isArray(n))throw new Error(`Arguments on a declarative method must be wrapped in an array.
Works:
<example :methodCall="[256]" />
Doesn't work:
<example :methodCall="256" />`);d.bind(e.instance)(...n)}else J(i,c,void 0)!==void 0?vt(i,c,n===""?!0:n):console.log(`No property ${c} found on ${i}`);const p=((s=i==null?void 0:i.texture)==null?void 0:s.type)||(i==null?void 0:i.type);if(typeof p=="string"){const a=p.toLowerCase();switch(!0){case a.includes("material"):i.needsUpdate=!0;break;case(a.includes("camera")&&i.updateProjectionMatrix):i.updateProjectionMatrix();break}}return e}const ln={x:"position.x",y:"position.y",z:"position.z"},_e=["","parameters"],Ge=["args","attach","attachArray","is.default","isDefault","key","onAdded","ref","src"],un=["geometry","material"],dn=(e,t,r,n)=>{const o={type:e,props:n};if(V(o))return Ct(o);const i=Pt(o);return un.forEach(d=>{e.toLowerCase().endsWith(d)&&(i.props.attach=d)}),i},pn=(e,t,r)=>{var n,o,c,i,d,p,s;if(!t)throw new Error("missing parent");if(t.insertBefore(e,r),!(e.metaType==="commentMeta"||e.metaType==="textMeta")&&(V(e)&&(V(t)||oe(t))&&t.domElement.appendChild(e.domElement),j(e))){let a=t.metaType;if(a==="textMeta"||a==="commentMeta"){const l=t.getPath();for(let f=l.length-1;f>=0;f--)if(l[f].metaType!=="textMeta"&&l[f].metaType!=="commentMeta"){t=l[f];break}}j(e)&&((n=e.instance)!=null&&n.isObject3D)&&j(t)&&((o=t.instance)!=null&&o.isObject3D)&&((i=(c=t.instance)==null?void 0:c.add)==null||i.call(c,e.instance)),(d=e==null?void 0:e.props)!=null&&d.attach&&j(t)&&(t!=null&&t.instance)&&(((p=e.type)==null?void 0:p.toLowerCase().endsWith("loader"))&&e.props.src&&(e.props.attach||e.props.attachArray)?fn(e,t):ne(e,t,e.props.attach)),(s=e.props)!=null&&s.onAdded&&e.props.onAdded({instance:e.instance})}};function fn(e,t){var n;const r=e.instance;if(t.attached=t.attached||{},t.attachedArray=t.attachedArray||{},!!e.props.attach)if(((n=e.type)==null?void 0:n.toLowerCase())==="textureloader"){const c=r.load(e.props.src);ne(e,t,e.props.attach,c)}else r.load(e.props.src,o=>{ne(e,t,e.props.attach,o)},null,o=>{throw new Error(o)})}function ne(e,t,r,n){const o=n??e.instance,c=t.instance;e.props.attach===r&&(t.attached={[r]:o,...t.attached||{}},c[r]=n??e.instance),e.props.attachArray===r&&(t.attachedArray[e.props.attachArray]||(t.attachedArray[e.props.attachArray]=[]),t.attachedArray[e.props.attachArray].push(o),c[r]=[c[r]])}const mn=e=>{if(!e)return;const t=[];e.walk(r=>(t.push(r),!0)),t.forEach(r=>{var n,o,c;if(j(r)){(o=(n=r.instance)==null?void 0:n.removeFromParent)==null||o.call(n);const i=r.type!=="scene"&&((c=r.instance)==null?void 0:c.dispose);i&&i.bind(r.instance)(),r.instance=null}r.drop()})},hn=()=>{const e=w([]);return{nodeOps:{createElement:dn,createText(r){return Et({text:r})},createComment(r){return Rt({text:r})},insert:pn,nextSibling(r){const n=r.nextSibling;return n||null},parentNode(r){const n=r.parentNode;return n||null},patchProp(r,n,o,c){if(V(r)){n==="style"?Object.keys(c).forEach(i=>{r.domElement.style[i]=c[i]}):r.domElement.setAttribute(n,c);return}oe(r)||n.startsWith("$")||cn({node:r,key:n,interactables:e,value:c})},remove:mn,setElementText(){},setText(){}},interactables:e}},yn=I({name:"BridgeComponent",props:{app:{type:Object},root:{type:Object},appSetup:{type:Function,default:e=>e}},setup(e,t){var c;if(!e.app&&!e.root)throw new Error("app or root required as <bridge> prop");const r=w();let n=e.appSetup(e.app??st(e.root,t.attrs));const o=((c=mt())==null?void 0:c.provides)??{};return Object.keys(o).forEach(i=>{n==null||n.provide(i,E(i))}),Oe(()=>{n==null||n.mount(r.value)}),pt(()=>{n==null||n.unmount(),n=null}),()=>A("div",{ref:r},null)}}),nt={install(e){e.component("lunchbox",yn)}},bn=()=>E(Je),je=()=>E(Ye),gn=e=>{const t=je();if(t.value){e(t.value);return}let r=null;r=X(je(),n=>{n&&(e(n),r==null||r())},{immediate:!0})},rt=()=>E(ke),xn=()=>E(ze),vn=()=>E(Xe),An=()=>E(Ze),ot=()=>E(Qe),st=(e,t={})=>{const{nodeOps:r,interactables:n}=hn(),o=ft(r).createApp(e,t);o.provide(Qe,n),Object.keys(Te).forEach(s=>{o==null||o.component(s,Te[s])}),o.provide(qt,s=>{o.setCustomRender(s)}),o.provide(Vt,()=>{o.clearCustomRender()});const c=[];o.provide(Xt,c),o.provide(He,(s,a=1/0)=>{a===1/0?c.push(s):c.splice(a,0,s)}),o.provide(We,s=>{if(isFinite(s))c.splice(s,1);else{const a=c.findIndex(l=>l==s);a!==-1&&c.splice(a,1)}});const i=[];o.provide(Yt,i),o.provide(Jt,(s,a=1/0)=>{a===1/0?i.push(s):i.splice(a,0,s)}),o.provide(Qt,s=>{if(isFinite(s))i.splice(s,1);else{const a=i.findIndex(l=>l==s);a!==-1&&i.splice(a,1)}}),o.config.globalProperties.lunchbox=Me({afterRender:i,beforeRender:c,camera:null,dpr:1,frameId:-1,renderer:null,scene:null,watchStopHandle:null}),o.provide(ke,o.config.globalProperties.lunchbox),o.provide(ze,s=>{Object.keys(s).forEach(a=>{const l=a;o.config.globalProperties.lunchbox[l]=s[l]})}),o.provide(qe,o.config.globalProperties.lunchbox.frameId),o.provide(Ve,o.config.globalProperties.lunchbox.watchStopHandle);const{mount:d}=o;o.mount=(s,...a)=>{const l=typeof s=="string"?document.querySelector(s):s,f=new G.RendererRootNode({domElement:l,isLunchboxRootNode:!0,name:"root",metaType:"rootMeta",type:"root",uuid:"LUNCHBOX_ROOT"});return o.rootNode=f,o.provide(Zt,f),d(f,...a)},o.extend=s=>(It({app:o,...s}),o);const p=[];return o.provide(Ze,p),o.setCustomRender=s=>{o&&(o.customRender=s)},o.clearCustomRender=()=>{o&&(o.customRender=null)},o.provide(Xe,o),o.provide(Ye,q(()=>o.config.globalProperties.lunchbox.renderer)),o.provide(en,q(()=>o.config.globalProperties.lunchbox.scene)),o.provide(Je,q(()=>o.config.globalProperties.lunchbox.camera)),o._props,o},Rn={__name:"LunchboxApp",setup(e){return(t,r)=>{const n=_("boxGeometry"),o=_("MeshBasicMaterial");return re(),$e(ee(nt),null,{default:ht(()=>[z("mesh",null,[A(n),A(o,{color:"red"})])]),_:1})}}},Cn={__name:"地球",setup(e){const t=st(Rn);return(r,n)=>(re(),$e(ee(nt),{app:ee(t)},null,8,["app"]))}},En=z("h1",{id:"地球",tabindex:"-1"},[Ue("地球 "),z("a",{class:"header-anchor",href:"#地球","aria-label":'Permalink to "地球"'},"​")],-1),Pn=z("h2",{id:"效果展示",tabindex:"-1"},[Ue("效果展示 "),z("a",{class:"header-anchor",href:"#效果展示","aria-label":'Permalink to "效果展示"'},"​")],-1),Fn=bt("",4),Nn=JSON.parse('{"title":"地球","description":"","frontmatter":{},"headers":[],"relativePath":"web/js/threejs/demos/地球.md","lastUpdated":1688882026000}'),Bn={name:"web/js/threejs/demos/地球.md"},Tn=Object.assign(Bn,{setup(e){return(t,r)=>(re(),yt("div",null,[En,Pn,A(Cn),Fn]))}});export{Nn as __pageData,Tn as default};
