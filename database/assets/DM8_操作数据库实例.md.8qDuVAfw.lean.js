import{_ as i,c as a,o as n,a3 as l}from"./chunks/framework.D49FT0pj.js";const o=JSON.parse('{"title":"操作数据库实例","description":"","frontmatter":{},"headers":[],"relativePath":"DM8/操作数据库实例.md","filePath":"DM8/操作数据库实例.md","lastUpdated":1746585786000}'),t={name:"DM8/操作数据库实例.md"};function h(e,s,p,k,d,r){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="操作数据库实例" tabindex="-1">操作数据库实例 <a class="header-anchor" href="#操作数据库实例" aria-label="Permalink to &quot;操作数据库实例&quot;">​</a></h1><h2 id="创建数据库" tabindex="-1">创建数据库 <a class="header-anchor" href="#创建数据库" aria-label="Permalink to &quot;创建数据库&quot;">​</a></h2><h3 id="dminit-命令行创建数据库实例" tabindex="-1">dminit 命令行创建数据库实例 <a class="header-anchor" href="#dminit-命令行创建数据库实例" aria-label="Permalink to &quot;dminit 命令行创建数据库实例&quot;">​</a></h3><p>dminit 是 DM 初始化数据库的命令行工具，位于 DM 安装目录 bin 下。</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># dmdba</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dm8/bin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./dminit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> help</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./dminit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> path=/dm8/data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db_name=DMTEST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instance_NAME=DMTESTSVR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysdba_pwd=Dameng123</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port_num=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5238</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PAGE_SIZE=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span></span></code></pre></div><p>dminit 方式创建数据库不会自动注册数据库服务（DM 数据库配置助手方式默认自动注册数 据库服务），所以不能以服务方式启动数据库，如果要以服务方式启动，则需要注册数据库 服务。</p><h3 id="root-执行注册服务脚本" tabindex="-1">root 执行注册服务脚本 <a class="header-anchor" href="#root-执行注册服务脚本" aria-label="Permalink to &quot;root 执行注册服务脚本&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cd $DM_HOME/script/root</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dm8/script/root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./dm_service_installer.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dmserver</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DMTESTSVR</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -dm_ini</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dm8/data/DMTEST/dm.ini</span></span></code></pre></div><h3 id="root-执行删除服务脚本" tabindex="-1">root 执行删除服务脚本 <a class="header-anchor" href="#root-执行删除服务脚本" aria-label="Permalink to &quot;root 执行删除服务脚本&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cd $DM_HOME/script/root</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dm8/script/root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./dm_service_uninstaller.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./dm_service_uninstaller.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DmServiceDMTESTSVR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dm8/script/root/dm_service_uninstaller.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DmServiceDMTESTSVR</span></span></code></pre></div><h2 id="连接数据库" tabindex="-1">连接数据库 <a class="header-anchor" href="#连接数据库" aria-label="Permalink to &quot;连接数据库&quot;">​</a></h2><p>如果使用客户端工具连接远端数据库服务器，需要开放数据库服务器防火墙对应端口（开放 端口后需 reload）：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-port=5236/tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --zone=public</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --list-ports</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者直接关闭数据库服务器的防火墙</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> firewalld</span></span></code></pre></div><h3 id="disql-命令行方式连接数据库" tabindex="-1">disql 命令行方式连接数据库 <a class="header-anchor" href="#disql-命令行方式连接数据库" aria-label="Permalink to &quot;disql 命令行方式连接数据库&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># dmdba</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dm8/bin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./disql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysdba/Dameng123:5238</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># sysdba 用户名</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Dameng123 密码</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5236 端口</span></span></code></pre></div><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> V$</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> instance_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v$instance;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 退出</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">exit</span></span></code></pre></div><h2 id="启动和关闭数据库" tabindex="-1">启动和关闭数据库 <a class="header-anchor" href="#启动和关闭数据库" aria-label="Permalink to &quot;启动和关闭数据库&quot;">​</a></h2><h3 id="dm-数据库启动顺序" tabindex="-1">DM 数据库启动顺序 <a class="header-anchor" href="#dm-数据库启动顺序" aria-label="Permalink to &quot;DM 数据库启动顺序&quot;">​</a></h3><p>DM 数据库启动顺序：读取配置参数文件 dm.ini,找到控制文件 dm.ctl，启动后台进程和线程，启动数据库实例，启动到 mount 状态，根据控制文件中的数据文件路径和联机日志文件路径，找到并打开数据文件和联机日志，启动到 OPEN 状态。</p><ul><li>DM：shutdown -&gt;mount-&gt;open</li><li>Oracle 启动顺序：shutdown -&gt; nomount-&gt;mount-&gt;open</li><li>Shutdown：关闭状态</li><li>Mount：配置状态，此时可以修改数据库归档配置、主机备机等模式，不能进行数据文件的读写。此时数据库不能对外正常提供服务。可以读取内存中或者控制文件中的表（V$开头的动态视图）。</li><li>MOUNT 状态下，可以配置归档，设置主备模式，修改联机日志文件路径等，MOUNT 状态下不能读写数据（但可以读动态性能视图中的数据，因为动态视图数据来源于控制文件或内存中的，比如 v$datafile、v$database 等），MOUNT 状态数据库不能对外提供服务（不能读写数据，业务中断）。</li><li>Open：打开状态，此时数据库提供正常的服务。可以读写数据文件。正常访问表，读取数据。</li><li>Suspend：只读状态，只能读，不能写（DML 操作一旦 commit，数据库即会被挂起）。</li><li>MOUNT 和 OPEN 可以相互转换（与 Oracle 不同）。SUSPEND 和 OPEN 也可以相互转换。但 MOUNT 和 SUSPEND 之间不能相互转换。</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v$instance;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">alter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mount;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v$instance;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">alter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> database</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v$instance;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">alter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> database</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> suspend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_test;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">insert into</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_test(id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v$instance;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v$</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v$datafile;</span></span></code></pre></div><h3 id="dm-数据库启动" tabindex="-1">DM 数据库启动 <a class="header-anchor" href="#dm-数据库启动" aria-label="Permalink to &quot;DM 数据库启动&quot;">​</a></h3><ul><li>root 用户启动</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># systemctl 服务方式管理（CentOS6 使用 service 命令）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># systemctl start|restart|status|stop|enable|disable DmServiceDMTESTSVR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DmServiceDMTESTSVR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DmServiceDMTESTSVR</span></span></code></pre></div><ul><li>dmdba 用户启动 <ul><li>（1） 前台启动方式（dmserver）：如果没有注册数据库服务为 Linux 系统服务，则只能使用此方式启动。其他的启动方式都需 要注册数据库服务。 <ul><li>启动：<code>cd /dm8/bin &amp;&amp; ./dmserver /dm8/data/DMTEST/dm.ini</code></li><li>启动到 MOUNT 状态：<code>cd /dm8/bin &amp;&amp; ./dmserver /dm8/data/DMTEST/dm.ini mount</code></li></ul></li><li>（2） 后台启动方式（DmServiceDMSERVER） <ul><li>查看服务：<code>ll /dm8/bin/Dm*</code></li><li><code>cd /dm8/bin &amp;&amp; ./DmServiceDMTESTSVR start</code></li><li><code>cd /dm8/bin &amp;&amp; ./DmServiceDMTESTSVR stop</code></li><li>启动到 MOUNT 状态：<code>cd /dm8/bin &amp;&amp; ./DmServiceDMTESTSVR start mount</code></li><li><code>cd /dm8/bin &amp;&amp; ./DmServiceDMTESTSVR status</code></li><li><code>cd /dm8/bin &amp;&amp; ./DmServiceDMTESTSVR restart</code></li></ul></li></ul></li></ul>`,25)]))}const g=i(t,[["render",h]]);export{o as __pageData,g as default};
