import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.92222dd1.js";const h=JSON.parse('{"title":"LNMP 安装教程 CentOS","description":"","frontmatter":{},"headers":[],"relativePath":"server/PHP/LNMP环境安装笔记-CentOS.md","lastUpdated":null}'),p={name:"server/PHP/LNMP环境安装笔记-CentOS.md"},e=l(`<h1 id="lnmp-安装教程-centos" tabindex="-1">LNMP 安装教程 CentOS <a class="header-anchor" href="#lnmp-安装教程-centos" aria-label="Permalink to &quot;LNMP 安装教程 CentOS&quot;">​</a></h1><p>安装环境： centos7.6 + nginx + PHP7.3.* + mysql5.5</p><h2 id="安装-nginx" tabindex="-1">安装 nginx <a class="header-anchor" href="#安装-nginx" aria-label="Permalink to &quot;安装 nginx&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># yum 安装 nginx</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">update</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remove</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 设定防火墙，允许 http与https封包通过</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">firewalld.service</span></span>
<span class="line"><span style="color:#FFCB6B;">firewall-cmd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--permanent</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--zone=public</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--add-service=http</span></span>
<span class="line"><span style="color:#FFCB6B;">firewall-cmd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--permanent</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--zone=public</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--add-service=https</span></span>
<span class="line"><span style="color:#FFCB6B;">firewall-cmd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--reload</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 启动nginx并将其设定为开机自启动</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">enable</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"></span></code></pre></div><ul><li>测试 nginx安装是否成功：直接访问IP地址，出现 nginx页面，说明安装成功</li><li>配置nginx 将 <code>/etc/nginx/nginx.conf</code> 配置文件内的 默认server模块 监听 8080端口，后面用 <code>/etc/nginx/conf.d/default.conf</code> 监听 80端口</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 修改nginx的配置文件 </span></span>
<span class="line"><span style="color:#FFCB6B;">vim</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/nginx.conf</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># listen       80 default_server;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># listen       [::]:80 default_server;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">listen</span><span style="color:#A6ACCD;">       </span><span style="color:#F78C6C;">8080</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default_server</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">listen</span><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">::</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">:8080 </span><span style="color:#C3E88D;">default_server</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">server_name</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">_</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">root</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">/usr/share/nginx/html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># Load configuration files for the default server block.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">include</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/default.d/</span><span style="color:#A6ACCD;">*</span><span style="color:#C3E88D;">.conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">error_page</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">404</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/404.html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/40x.html</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">error_page</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">502</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">503</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">504</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/50x.html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/50x.html</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 添加段代码</span></span>
<span class="line"><span style="color:#FFCB6B;">vim</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/conf.d/default.conf</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">listen</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">server_name</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">root</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/share/nginx/html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">index</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">index.php</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">index.html</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">index.htm</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#charset koi8-r;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#access_log /var/log/nginx/log/host.access.log main;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">try_files</span><span style="color:#A6ACCD;"> $uri $uri</span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/index.php?</span><span style="color:#A6ACCD;">$query_string</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#error_page 404 /404.html;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># redirect server error pages to the static page /50x.html</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">error_page</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">502</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">503</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">504</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/50x.html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/50x.html</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#location ~ \\.php$ {</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># proxy_pass http://127.0.0.1;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">~</span><span style="color:#A6ACCD;"> \\.</span><span style="color:#C3E88D;">php</span><span style="color:#A6ACCD;">$ </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">fastcgi_pass</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">127.0.0.1:</span><span style="color:#F78C6C;">9000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">fastcgi_index</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">index.php</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">fastcgi_param</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">SCRIPT_FILENAME</span><span style="color:#A6ACCD;"> $document_root$fastcgi_script_name</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">include</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">fastcgi_params</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">try_files</span><span style="color:#A6ACCD;"> $uri $uri</span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/index.php?</span><span style="color:#A6ACCD;">$query_string</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 重启nginx服务</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"></span></code></pre></div><h3 id="配置-https" tabindex="-1">配置 https <a class="header-anchor" href="#配置-https" aria-label="Permalink to &quot;配置 https&quot;">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 先备份，便于出错恢复</span></span>
<span class="line"><span style="color:#A6ACCD;">mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf-bak</span></span>
<span class="line"><span style="color:#A6ACCD;"># 编辑配置信息</span></span>
<span class="line"><span style="color:#A6ACCD;">vim /etc/nginx/conf.d/default.conf</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>监听 443 端口 , 并 将 80端口 转发 到 443</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">    # 监听443端口</span></span>
<span class="line"><span style="color:#A6ACCD;">    listen 443;</span></span>
<span class="line"><span style="color:#A6ACCD;">    #你的域名</span></span>
<span class="line"><span style="color:#A6ACCD;">    server_name demo.test; </span></span>
<span class="line"><span style="color:#A6ACCD;">    ssl on;</span></span>
<span class="line"><span style="color:#A6ACCD;">    # ssl证书的pem文件路径</span></span>
<span class="line"><span style="color:#A6ACCD;">    ssl_certificate  /root/card/demo.test.pem;</span></span>
<span class="line"><span style="color:#A6ACCD;">    # ssl证书的key文件路径</span></span>
<span class="line"><span style="color:#A6ACCD;">    ssl_certificate_key /root/card/demo.test.key;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    root /usr/share/nginx/html;</span></span>
<span class="line"><span style="color:#A6ACCD;">    index index.php index.html index.htm;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    location / {</span></span>
<span class="line"><span style="color:#A6ACCD;">        try_files $uri $uri/ /index.php?$query_string;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    location ~ \\.php$ {</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_pass 127.0.0.1:9000;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_index index.php;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span></span>
<span class="line"><span style="color:#A6ACCD;">        include fastcgi_params;</span></span>
<span class="line"><span style="color:#A6ACCD;">        try_files $uri $uri/ /index.php?$query_string;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">    listen 80;</span></span>
<span class="line"><span style="color:#A6ACCD;">    server_name demo.test;</span></span>
<span class="line"><span style="color:#A6ACCD;">    #将请求转成https</span></span>
<span class="line"><span style="color:#A6ACCD;">    rewrite ^(.*)$ https://$host$1 permanent;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="yum-安装-php7-3" tabindex="-1">yum 安装 php7.3.* <a class="header-anchor" href="#yum-安装-php7-3" aria-label="Permalink to &quot;yum 安装 php7.3.*&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 采用 Remi和EPEL仓库 内的7.3.1的安装资源</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 安装EPEL</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">epel-release</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 安装remi</span></span>
<span class="line"><span style="color:#FFCB6B;">rpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-Uvh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 安装php7.3</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--enablerepo=remi-php73</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 测试是否正确安装</span></span>
<span class="line"><span style="color:#FFCB6B;">php</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 安装php7.3系列的附属组件模块</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--enablerepo=remi-php73</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-xml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-soap</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-xmlrpc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-mbstring</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-json</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-gd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-mcrypt</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-mysqlnd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-process</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-intl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-redis</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-bcmath</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-pecl-zip</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 通过下列命令查看还可以安装哪些组件</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--enablerepo=remi-php73</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">search</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">grep</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php73</span></span>
<span class="line"></span></code></pre></div><ul><li>测试运行php脚本</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">vim</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/share/nginx/html/phpinfo.php</span></span>
<span class="line"></span></code></pre></div><ul><li><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#A6ACCD;">php</span></span>
<span class="line"><span style="color:#82AAFF;">phpinfo</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span></code></pre></div><ul><li>注：在nginx的内容存放目录 /usr/share/nginx/html 内建立 phpinfo.php文件，通过浏览器访问该文件（访问地址：<a href="http://xn--ip-fr5c86lx7z/phpinfo.php%EF%BC%89%EF%BC%8C%E8%8B%A5%E8%83%BD%E8%BF%90%E8%A1%8C%E8%AF%B4%E6%98%8E%E6%88%90%E5%8A%9F%EF%BC%8C%E5%90%A6%E5%88%99%E9%9C%80%E5%AE%89%E8%A3%85php-fpm" target="_blank" rel="noreferrer">http://服务器ip/phpinfo.php），若能运行说明成功，否则需安装php-fpm</a></li></ul></li><li><p>安装php-fpm，并对nginx进行配置，使得nginx可以通过php-fpm来处理php的任务</p></li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 安装php-fpm并设置为开机启动</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--enablerepo=remi-php73</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-fpm</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-fpm</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">enable</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-fpm</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 配置PHP运行环境</span></span>
<span class="line"><span style="color:#FFCB6B;">vim</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/php.ini</span></span>
<span class="line"></span></code></pre></div><ul><li><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">cgi.fix_pathinfo = 1</span></span>
<span class="line"><span style="color:#A6ACCD;">date.timezone = PRC</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 修改php-fpm 的配置文件</span></span>
<span class="line"><span style="color:#FFCB6B;">vim</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/php-fpm.d/www.conf</span></span>
<span class="line"></span></code></pre></div><ul><li><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www</span><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">#（默认为apache，以后的PHP项目都用www来运行）</span></span>
<span class="line"><span style="color:#FFCB6B;">group</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www</span><span style="color:#A6ACCD;">       </span><span style="color:#676E95;font-style:italic;">#（默认为apache，以后的PHP项目都用www来运行）</span></span>
<span class="line"><span style="color:#FFCB6B;">listen</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">127.0.0.1:</span><span style="color:#F78C6C;">9000</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 监听 9000端口，与 nginx配置文件 /etc/nginx/conf.d/default.conf 的 fastcgi_pass 127.0.0.1:9000; 保持一致</span></span>
<span class="line"><span style="color:#FFCB6B;">listen.owner</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nobody</span></span>
<span class="line"><span style="color:#FFCB6B;">listen.group</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nobody</span></span>
<span class="line"></span></code></pre></div></li><li>添加 www:www 用户组:用户名（因为我们的 php-fpm 是 用 www:www 来运行的，不添加的话，启动php-fpm会报错）</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">groupadd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www</span></span>
<span class="line"><span style="color:#FFCB6B;">useradd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-g</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 重启php-fpm服务</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-fpm</span></span>
<span class="line"></span></code></pre></div><ul><li><p>注：如果项目运行中报错：Non-static method Redis::hGet() cannot be called statically，说明 我们安装的redis扩展 和 laravel自带的扩展 predis/predis 发生冲突了</p></li><li><p>redis扩展冲突的两种解决办法：</p><ul><li>删除我们安装的 php-redis 扩展</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--enablerepo=remi-php73</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remove</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">php-redis</span></span>
<span class="line"></span></code></pre></div><ul><li>删除 laravel项目 composer.json 中的 predis/predis</li></ul></li><li><p>再次测试info.php页面是否可以打开，访问地址：<a href="http://xn--ip-fr5c86lx7z/phpinfo.php" target="_blank" rel="noreferrer">http://服务器ip/phpinfo.php</a></p></li></ul><h2 id="yum-安装-php7-4" tabindex="-1">yum 安装 php7.4.* <a class="header-anchor" href="#yum-安装-php7-4" aria-label="Permalink to &quot;yum 安装 php7.4.*&quot;">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 采用 Remi和EPEL仓库内的安装资源</span></span>
<span class="line"><span style="color:#A6ACCD;"># 安装EPEL</span></span>
<span class="line"><span style="color:#A6ACCD;">yum install epel-release</span></span>
<span class="line"><span style="color:#A6ACCD;"># 安装remi (下面 remi-release-7.rpm 或 remi-release-8.rpm 任选一个)</span></span>
<span class="line"><span style="color:#A6ACCD;">rpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</span></span>
<span class="line"><span style="color:#A6ACCD;">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-8.rpm</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># 安装php7.4</span></span>
<span class="line"><span style="color:#A6ACCD;">yum --enablerepo=remi install php74-php</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># 安装所需要php扩展模块，注：扩展安装格式php74-php-扩展模块名，缺什么扩展只要按照格式安装相应模块即可</span></span>
<span class="line"><span style="color:#A6ACCD;">yum --enablerepo=remi install php74-php php74-php-fpm php74-php-mbstring php74-php-gd php74-php-xml php74-php-sockets php74-php-session php74-php-snmp php74-php-mysql</span></span>
<span class="line"><span style="color:#A6ACCD;"># 安装 phpize （php74-php-fpm-devel）</span></span>
<span class="line"><span style="color:#A6ACCD;">yum --enablerepo=remi install php74-php php74-php-devel</span></span>
<span class="line"><span style="color:#A6ACCD;"># 安装扩展 bcmath</span></span>
<span class="line"><span style="color:#A6ACCD;">yum --enablerepo=remi install php74-php-bcmath</span></span>
<span class="line"><span style="color:#A6ACCD;">yum --enablerepo=remi install php74-php-posix</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">#运行并查看版本</span></span>
<span class="line"><span style="color:#A6ACCD;">php74 -v</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># 操作 php-fpm 命令</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl start php74-php-fpm</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl restart php74-php-fpm</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl stop php74-php-fpm</span></span>
<span class="line"><span style="color:#A6ACCD;"># 添加自动启动</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl enable php74-php-fpm</span></span>
<span class="line"><span style="color:#A6ACCD;"># 查看 php-fpm 运行状态</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl status php74-php-fpm</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">#链接php文件</span></span>
<span class="line"><span style="color:#A6ACCD;">ln -s /usr/bin/php74 /usr/bin/php</span></span>
<span class="line"><span style="color:#A6ACCD;"># 查看php7.4的安装路径</span></span>
<span class="line"><span style="color:#A6ACCD;">whereis php74</span></span>
<span class="line"><span style="color:#A6ACCD;"># 看到 /usr/bin/php74</span></span>
<span class="line"><span style="color:#A6ACCD;">cd /usr/bin/ &amp;&amp; ll</span></span>
<span class="line"><span style="color:#A6ACCD;"># 查看 /usr/bin/php74 具体指向路径为：php74 -&gt; /opt/remi/php74/root/usr/bin/php，说明 php7.4安装在了 /opt/remi/php74/ 下</span></span>
<span class="line"><span style="color:#A6ACCD;"># 查看 phpize 是否安装</span></span>
<span class="line"><span style="color:#A6ACCD;">cd /opt/remi/php74/root/usr/bin &amp;&amp; ll</span></span>
<span class="line"><span style="color:#A6ACCD;"># 链接 phpize 文件</span></span>
<span class="line"><span style="color:#A6ACCD;">ln -s /opt/remi/php74/root/usr/bin/phpize /usr/bin/phpize</span></span>
<span class="line"><span style="color:#A6ACCD;"># 链接 php-config 文件</span></span>
<span class="line"><span style="color:#A6ACCD;">ln -s /opt/remi/php74/root/usr/bin/php-config /usr/bin/php-config</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>如果报错如下，说明扩展包未安装</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Can&#39;t find PHP headers in /opt/remi/php74/root/usr/include/php</span></span>
<span class="line"><span style="color:#A6ACCD;">The php74-php-devel package is required for use of this command.</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>报错解决办法</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 安装 phpize （php74-php-fpm-devel）</span></span>
<span class="line"><span style="color:#A6ACCD;">yum --enablerepo=remi install php74-php php74-php-devel</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>修改配置文件</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">vim /etc/opt/remi/php74/php-fpm.d/www.conf</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># user = apache</span></span>
<span class="line"><span style="color:#A6ACCD;"># group = apache</span></span>
<span class="line"><span style="color:#A6ACCD;">user = www</span></span>
<span class="line"><span style="color:#A6ACCD;">group = www</span></span>
<span class="line"><span style="color:#A6ACCD;">listen = 127.0.0.1:9000</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>配置文件 <code>php.ini</code> 位置： <code>/etc/opt/remi/php74/php.ini</code></p><h2 id="yum-安装-php8-0" tabindex="-1">yum 安装 php8.0 <a class="header-anchor" href="#yum-安装-php8-0" aria-label="Permalink to &quot;yum 安装 php8.0&quot;">​</a></h2><ul><li>添加remi源（可能需要提前安装epel-release）</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">yum install -y https://rpms.remirepo.net/enterprise/remi-release-7.rpm</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ul><li>单独启用php80的源（没有yum-config-manager命令的话需要安装yum-utils）</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">yum-config-manager --disable &#39;remi-php*&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">yum-config-manager --enable remi-php80</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ul><li>安装php及其拓展</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">yum install -y php php-bcmath php-cli php-common php-devel \\</span></span>
<span class="line"><span style="color:#A6ACCD;">php-fpm php-gd php-intl php-ldap php-mbstring php-mysqlnd \\</span></span>
<span class="line"><span style="color:#A6ACCD;">php-odbc php-pdo php-pear php-pecl-xmlrpc php-pecl-zip php-process \\</span></span>
<span class="line"><span style="color:#A6ACCD;">php-snmp php-soap php-sodium php-xml</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ul><li>版本验证</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">php -v</span></span>
<span class="line"><span style="color:#A6ACCD;"># 看到 php 8.0 了</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><blockquote><p>注意：如果提示缺少什么依赖没安装，就随手先安装了再安装 php 就好了</p></blockquote><h2 id="卸载-php" tabindex="-1">卸载 PHP <a class="header-anchor" href="#卸载-php" aria-label="Permalink to &quot;卸载 PHP&quot;">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 先查看 PHP安装包列表</span></span>
<span class="line"><span style="color:#A6ACCD;">rpm -qa | grep php</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>安装包列表</p><blockquote><p>php-common-7.3.25-1.el7.remi.x86_64</p></blockquote><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 卸载对应安装包：yum remove 安装包</span></span>
<span class="line"><span style="color:#A6ACCD;">yum remove php-common-7.3.25-1.el7.remi.x86_64</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="卸载-php7-4" tabindex="-1">卸载 php7.4 <a class="header-anchor" href="#卸载-php7-4" aria-label="Permalink to &quot;卸载 php7.4&quot;">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">yum remove php74-php*</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="安装-mysql-centos7-快速安装-mariadb5-5" tabindex="-1">安装 MySQL - Centos7 快速安装 MariaDB5.5 <a class="header-anchor" href="#安装-mysql-centos7-快速安装-mariadb5-5" aria-label="Permalink to &quot;安装 MySQL - Centos7 快速安装 MariaDB5.5&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 安装</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mariadb</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mariadb-server</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 启动和开机启动</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mariadb</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">enable</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mariadb</span></span>
<span class="line"></span></code></pre></div><ul><li>设置root密码</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">mysql_secure_installation</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Remove anonymous users? [Y/n] Y 删除匿名用户：是</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Disallow root login remotely? [Y/n] n 是否禁止远程访问：否</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Remove test database and access to it? [Y/n] n # 这里不删除测试数据库</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Reload privilege tables now? [Y/n] Y # 这里必须Y确认才能使修改生效</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 登录 MySQL</span></span>
<span class="line"><span style="color:#FFCB6B;">mysql</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span></span>
<span class="line"></span></code></pre></div><ul><li>注：解决 mysql 1130 远程连接失败的问题（要在 阿里云 控制台 开启 3306访问权限，否则也是无法访问）</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 赋予并刷新MySQL权限</span></span>
<span class="line"><span style="color:#FFCB6B;">grant</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">privileges</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root@</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">identified</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">by</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mysql root用户的登录密码</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">grant</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">option</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">flush</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">privileges</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>注：如果 阿里云/腾讯云 控制台 已经开启了 3306权限，root用户远程访问权限也给了，还是无法连接，可以尝试重启服务器</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 重启 MySQL 服务器 - mariadb</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mariadb</span></span>
<span class="line"></span></code></pre></div><h3 id="连接报错的解决办法" tabindex="-1">连接报错的解决办法 <a class="header-anchor" href="#连接报错的解决办法" aria-label="Permalink to &quot;连接报错的解决办法&quot;">​</a></h3><p>错误：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">ERROR 1698 (28000): Access denied for user &#39;root&#39;@&#39;localhost&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>解决：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">use mysql;</span></span>
<span class="line"><span style="color:#A6ACCD;">update user set password = password(&#39;123456) where user = &#39;root&#39;;</span></span>
<span class="line"><span style="color:#A6ACCD;">flush privileges;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="安装git" tabindex="-1">安装git <a class="header-anchor" href="#安装git" aria-label="Permalink to &quot;安装git&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">git</span></span>
<span class="line"></span></code></pre></div><h2 id="全局安装composer-需要php执行-所以要先安装php" tabindex="-1">全局安装composer（需要PHP执行，所以要先安装php） <a class="header-anchor" href="#全局安装composer-需要php执行-所以要先安装php" aria-label="Permalink to &quot;全局安装composer（需要PHP执行，所以要先安装php）&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-sS</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://getcomposer.org/installer</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">php</span></span>
<span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mv</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">composer.phar</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/local/bin/composer</span></span>
<span class="line"></span></code></pre></div><h2 id="安装-npm" tabindex="-1">安装 npm <a class="header-anchor" href="#安装-npm" aria-label="Permalink to &quot;安装 npm&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm</span></span>
<span class="line"></span></code></pre></div><h2 id="安装-yarn-注意要先安装-npm" tabindex="-1">安装 yarn （注意要先安装 npm） <a class="header-anchor" href="#安装-yarn-注意要先安装-npm" aria-label="Permalink to &quot;安装 yarn （注意要先安装 npm）&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--silent</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://dl.yarnpkg.com/rpm/yarn.repo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tee</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/yum.repos.d/yarn.repo</span></span>
<span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yarn</span></span>
<span class="line"></span></code></pre></div><h2 id="安装-redis" tabindex="-1">安装 Redis <a class="header-anchor" href="#安装-redis" aria-label="Permalink to &quot;安装 Redis&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 由于CentOS官方yum源里面没有Redis,这里需要安装一个第三方的yum源,这里用了Fedora的epel仓库</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">epel-release</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># yum 安装 redis</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">redis</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 启动redis</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">redis</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 开机启动redis</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">enable</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">redis</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 修改端口号/密码等配置</span></span>
<span class="line"><span style="color:#FFCB6B;">vim</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/redis.conf</span></span>
<span class="line"></span></code></pre></div><ul><li><ul><li>注释掉ip绑定，大概在 line:61（bind 127.0.0.1 只允许本地调试，不注释掉的话，远程连接redis的时候会提示：redis.clients.jedis.exceptions.JedisConnectionException: java.net.ConnectException: Connection refused: connect） <br>/etc/redis.conf<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># bind 127.0.0.1</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li>关闭保护模式，大概在 line:80（不关闭的话远程这个redis会提示：redis.clients.jedis.exceptions.JedisDataException: DENIED Redis is running in protected mode ） <br>/etc/redis.conf<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">protected-mode no</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li></ul></li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 重启redis</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">redis</span></span>
<span class="line"></span></code></pre></div>`,81),o=[e];function t(c,r,i,C,y,A){return n(),a("div",null,o)}const d=s(p,[["render",t]]);export{h as __pageData,d as default};
